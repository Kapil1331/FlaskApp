{% extends "layout.html" %}
{% block title %}
    Academic Complex Floor 1 - {{ current_day }}
{% endblock %}
{% block content %}
<div class="seat-container">
    <div style="width: 100%; text-align: center;">
        <h2>Availability for {{ current_day }}</h2>
    </div>
    {% if not pdf %}
        <p>Which seat do you want to book?</p>
    {% endif %}    
    {% if error %}
        <p class="error-message">{{ error }}</p>
    {% endif %}
    {% if pdf %}
        <form class="booking-form" action="{{ url_for('generate_pdf') }}" method="POST">
            <input type="hidden" name="misno" value="{{ mis }}">
            <input type="hidden" name="receiptnum" value="{{ receiptnum }}">
            <input type="hidden" name="day" value="{{ current_day }}">
            <input type="hidden" name="row" value="{{ row }}">
            <input type="hidden" name="column" value="{{ column }}">
            <input type="submit" value="generatePdf">
        </form>
    {% endif %}
    {% if not pdf %}
    <form class="booking-form" action="{{ url_for('bookseat') }}" method="POST">
        <input type="hidden" name="misno" value="{{ mis }}">
        <input type="hidden" name="day" value="{{ current_day }}">
        <label for="row">Row:</label>
        <input type="number" id="row" name="row" min="1" max="{{ total_rows }}" required>
        
        <label for="column">Column:</label>
        <input type="number" id="column" name="column" min="1" max="{{ total_seats_per_row }}" required>
        
        <input type="submit" value="Book">
    </form>
    {% endif %}
    {% set total_rows = 25 %}
    {% set total_seats_per_row = 32 %}
    {% for row_num in range(1, total_rows + 1) %}
        <div class="seat-row">
            <div class="seat-label">Row {{ row_num }}</div>
            {% for seat_num in range(1, total_seats_per_row + 1) %}
                {% if seat_num == 7 or seat_num == 27 %}
                    <div class="passage"></div>
                {% endif %}
                <div class="passage2"></div>
                {% set seat_availability = get_auditorium_seat_availability(seat_num, row_num, current_day) %}
                <div class="seat {% if seat_availability == 'Occupied' %}selected{% endif %}">
                    {% if seat_availability == 'Vacant' %}
                        <span class="seat-number">{{ seat_num }}</span>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% endfor %}
</div>
{% if pdf %}
    <img src="{{ qrcode('Receipt Number : {} Seat Number {}-{}'.format(receiptnum, row, column)) }}">
{% endif %}

{% endblock %}